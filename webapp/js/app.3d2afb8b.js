(function(){"use strict";var e={7928:function(e,t,a){var n=a(5130),r=a(6768),o=a(4232);const l={class:"p-2"},s={class:"version-tag"},i={key:0,class:"d-flex justify-content-center full-screen-loading"};function u(e,t,a,n,u,c){const m=(0,r.g2)("el-tab-pane"),d=(0,r.g2)("el-tabs");return(0,r.uX)(),(0,r.CE)("div",l,[t[2]||(t[2]=(0,r.Lk)("h2",null,"Keyboard Simulator",-1)),(0,r.Lk)("div",s,(0,o.v_)(e.$store.state.vxMainVersion),1),e.$store.state.vxIsExecuting?((0,r.uX)(),(0,r.CE)("div",i,t[1]||(t[1]=[(0,r.Lk)("div",{class:"spinner-container"},[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")])],-1)]))):(0,r.Q3)("",!0),(0,r.bF)(d,{modelValue:u.activeName,"onUpdate:modelValue":t[0]||(t[0]=e=>u.activeName=e)},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(u.tabList,((e,t)=>((0,r.uX)(),(0,r.Wv)(m,{key:t,label:e.label,name:e.name},{default:(0,r.k6)((()=>[((0,r.uX)(),(0,r.Wv)((0,r.$y)(e.componentName)))])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])}const c={class:"powershell-panel p-1"},m={class:"input-group mb-3"},d={class:"row justify-content-around"},p={class:"col-4 d-flex"},f={class:"col-4"};function h(e,t,a,o,l,s){return(0,r.uX)(),(0,r.CE)("div",c,[(0,r.Lk)("div",m,[(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",placeholder:"Text to simulate","onUpdate:modelValue":t[0]||(t[0]=e=>l.inputText=e)},null,512),[[n.Jo,l.inputText]])]),(0,r.Lk)("div",d,[(0,r.Lk)("div",p,[t[3]||(t[3]=(0,r.Lk)("label",{for:"delaySec",class:"col-sm-8 col-form-label"},"Delay (second)",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",min:"0",class:"form-control",id:"delaySec","onUpdate:modelValue":t[1]||(t[1]=e=>l.psParams.delay=e)},null,512),[[n.Jo,l.psParams.delay]])]),(0,r.Lk)("div",f,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...e)=>s.sendPSrequest&&s.sendPSrequest(...e))},"EXECUTE")])])])}var b=a(4373);b.A.defaults.timeout=0;var v=b.A;a(4114);const g={filePath:"",generateParam:e=>{let t=[];t.unshift(g.filePath);for(const[a,n]of Object.entries(e))switch(a){case"delay":t.push(`-Delay ${n}`);break;case"enter":n&&t.push("-Enter ");break;case"raw":n&&t.push("-Raw ");break;default:break}return t}};var k=g,y={name:"PowershellPanel",props:{},data(){return{inputText:"",psParams:{delay:5}}},methods:{async getVersion(){const{data:e}=await v.get("http://localhost:9527/version")},async sendPSrequest(){try{this.$store.commit("updateExecuteState",!0),await navigator.clipboard.writeText(this.inputText),console.log(this.inputText),console.log(this.generateParam()),await v.post("http://localhost:9527/runScript",this.generateParam())}catch(e){console.log("API: runScript error. ",e)}finally{this.$store.commit("updateExecuteState",!1)}},generateParam(){return k.generateParam(this.psParams)}},created(){}},L=a(1241);const P=(0,L.A)(y,[["render",h],["__scopeId","data-v-0507036e"]]);var w=P;const S={class:"multi-line p-1"},I={class:"row justify-content-around mt-3"},x={class:"col-4 d-flex"},E={class:"col-4"};function C(e,t,a,o,l,s){const i=(0,r.g2)("MultiInput");return(0,r.uX)(),(0,r.CE)("div",S,[(0,r.bF)(i,{class:"mb-2",ref:"multiInputDOM"},null,512),(0,r.Lk)("div",I,[(0,r.Lk)("div",x,[t[2]||(t[2]=(0,r.Lk)("label",{for:"multiDelaySec",class:"col-sm-8 col-form-label"},"Delay (second)",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",min:"0",class:"form-control",id:"multiDelaySec","onUpdate:modelValue":t[0]||(t[0]=e=>l.psParams.delay=e)},null,512),[[n.Jo,l.psParams.delay]])]),(0,r.Lk)("div",E,[(0,r.Lk)("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...e)=>s.sendPSrequest&&s.sendPSrequest(...e))},"EXECUTE")])])])}a(1454);const V={class:"mb-3"},A={class:"col-1 d-flex justify-content-center align-items-center"},O={class:"col-10"},T={class:"col-1 d-flex justify-content-center align-items-center"},j=["onClick"];function M(e,t,a,n,l,s){const i=(0,r.g2)("el-input");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",V,[(0,r.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t[0]||(t[0]=(...e)=>s.addNewItem&&s.addNewItem(...e))},t[4]||(t[4]=[(0,r.eW)(" ADD"),(0,r.Lk)("br",null,null,-1),(0,r.eW)("new item ")])),(0,r.Lk)("button",{class:"btn btn-outline-primary btn-sm ms-1",onClick:t[1]||(t[1]=(...e)=>s.saveItem&&s.saveItem(...e))},t[5]||(t[5]=[(0,r.eW)(" SAVE"),(0,r.Lk)("br",null,null,-1),(0,r.eW)("to localStorage ")])),(0,r.Lk)("button",{class:"btn btn-outline-primary btn-sm ms-1",onClick:t[2]||(t[2]=(...e)=>s.restoreItem&&s.restoreItem(...e))},t[6]||(t[6]=[(0,r.eW)(" RESTORE"),(0,r.Lk)("br",null,null,-1),(0,r.eW)("from localStorage ")])),(0,r.Lk)("button",{class:"btn btn-outline-primary btn-sm ms-1",onClick:t[3]||(t[3]=(...e)=>s.clearItem&&s.clearItem(...e))},t[7]||(t[7]=[(0,r.eW)(" CLAER"),(0,r.Lk)("br",null,null,-1),(0,r.eW)("localStorage ")]))]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.inputList,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"row mb-1"},[(0,r.Lk)("div",A,(0,o.v_)(t+1),1),(0,r.Lk)("div",O,[(0,r.bF)(i,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t},null,8,["modelValue","onUpdate:modelValue"])]),(0,r.Lk)("div",T,[(0,r.Lk)("button",{class:"btn btn-outline-secondary btn-sm",onClick:t=>s.removeItem(e.id)}," - ",8,j)])])))),128))],64)}a(8992),a(4520);var N=a(4963),_={name:"MultiInput",components:{},data(){return{inputList:[]}},methods:{addNewItem(){this.inputList.push({id:(0,N.A)(),value:""})},saveItem(){window.localStorage.setItem("multiLineItem",JSON.stringify(this.inputList))},restoreItem(){let e=!0,t=window.localStorage.getItem("multiLineItem");return t&&(this.inputList=JSON.parse(t),e=!1),e},clearItem(){window.localStorage.removeItem("multiLineItem")},removeItem(e){this.inputList=this.inputList.filter((t=>t.id!==e))},initProcedure(){let e=this.restoreItem();e&&this.addNewItem()}},created(){this.initProcedure()}};const X=(0,L.A)(_,[["render",M]]);var F=X,W={name:"MultiLine",components:{MultiInput:F},data(){return{psParams:{delay:5,raw:!0}}},methods:{async sendPSrequest(){try{this.$store.commit("updateExecuteState",!0),await navigator.clipboard.writeText(this.generateString()),await v.post("http://localhost:9527/runScript",this.generateParam())}catch(e){console.log("API: runScript error. ",e)}finally{this.$store.commit("updateExecuteState",!1)}},generateString(){let e="{TAB}",t=this.$refs.multiInputDOM.inputList.map((e=>e.value));return t.join(e)},generateParam(){return k.generateParam(this.psParams)}},created(){}};const $=(0,L.A)(W,[["render",C]]);var D=$;const U={class:"mt-1"},q={class:"card card-body"},J={class:"row"},K={class:"mb-3"};function R(e,t,a,o,l,s){return(0,r.uX)(),(0,r.CE)("div",U,[(0,r.Lk)("div",q,[(0,r.Lk)("div",J,[(0,r.Lk)("div",K,[t[1]||(t[1]=(0,r.Lk)("label",{for:"filePath",class:"form-label"},"PowerShell File (Auto save to localStorage)",-1)),(0,r.bo)((0,r.Lk)("input",{class:"form-control",type:"text",id:"filePath","onUpdate:modelValue":t[0]||(t[0]=e=>l.psParamsPath=e)},null,512),[[n.Jo,l.psParamsPath]])])]),t[2]||(t[2]=(0,r.eW)(" This tool is based on article: ")),t[3]||(t[3]=(0,r.Lk)("a",{href:"https://blog.darkthread.net/blog/ps-paste-as-keystrokes/"},"PowerShell 小工具 - 將複製文字轉為鍵盤輸入",-1))])])}var B={name:"SettingCfg",components:{},data(){return{psParamsPath:""}},methods:{checkFilePath(){let e=window.localStorage.getItem("psFilePath")||"";k.filePath=e,this.psParamsPath=e}},watch:{psParamsPath:{handler(e){window.localStorage.setItem("psFilePath",e),k.filePath=e},deep:!0}},created(){this.checkFilePath()}};const Q=(0,L.A)(B,[["render",R]]);var z=Q,G={name:"App",components:{PowershellPanel:w,MultiLine:D,SettingCfg:z},data(){return{activeName:null,tabList:[{label:"一般模式",name:"normalInput",componentName:"PowershellPanel"},{label:"分行模式",name:"multiLine",componentName:"MultiLine"},{label:"設定",name:"setting",componentName:"SettingCfg"}]}},methods:{initActive(){this.tabList.length>0&&(this.activeName=this.tabList[0].name)},async getVersion(){const{data:e}=await v.get("http://localhost:9527/version");e&&e.version&&this.$store.commit("updateVersion",e.version)}},created(){this.initActive(),this.getVersion()}};const H=(0,L.A)(G,[["render",u],["__scopeId","data-v-0a9d0944"]]);var Y=H,Z=a(782);const ee=(0,Z.y$)({state(){return{vxMainVersion:"version unavailable",vxIsExecuting:!1}},mutations:{updateVersion(e,t){e.vxMainVersion=t},updateExecuteState(e,t){e.vxIsExecuting=t}}});var te=ee,ae=(a(3664),a(7454));a(4188);(0,n.Ef)(Y).use(te).use(ae.A).mount("#app")}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,o){if(!n){var l=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],o=e[c][2];for(var s=!0,i=0;i<n.length;i++)(!1&o||l>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(s=!1,o<l&&(l=o));if(s){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,l=n[0],s=n[1],i=n[2],u=0;if(l.some((function(t){return 0!==e[t]}))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(i)var c=i(a)}for(t&&t(n);u<l.length;u++)o=l[u],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},n=self["webpackChunkkeyboard_simulator"]=self["webpackChunkkeyboard_simulator"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(7928)}));n=a.O(n)})();
//# sourceMappingURL=app.3d2afb8b.js.map